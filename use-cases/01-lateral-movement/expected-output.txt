============================================================
UC-01: Lateral Movement Detection - Expected Output
============================================================

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
LAYER 1: Flink Signal Generation
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[INFO] Loading: sample-data.json
[INFO] Loaded 40 events
[INFO] Found 3 signal definitions

[SIGNAL] port-scan
  âœ“ Port scan: 10.0.0.5 â†’ 23 ports

[SIGNAL] connection-spike
  âœ“ Connection spike: 10.0.0.5 (+10.0Ïƒ)

[SIGNAL] privileged-access
  âœ“ Privileged access: 10.0.0.5 â†’ SMB, RDP, SSH

[INFO] Signals saved: signals-output.json

============================================================
Generated 3 signals
============================================================
  â€¢ PORT_SCAN: 10.0.0.5
  â€¢ CONNECTION_SPIKE: 10.0.0.5
  â€¢ PRIVILEGED_ACCESS: 10.0.0.5

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
LAYER 2: Python Correlation
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

[INFO] Database initialized: ../../output/detections.db
[INFO] Loading rules: rules.json
[INFO] Loaded rule: lateral_movement_detection
[INFO] Loading signals: ../signals-output.json
[INFO] Loaded 3 signals

============================================================
LAYER 2: Multi-Signal Correlation
============================================================

[CHECK] Source IP: 10.0.0.5
  Signals present: {'PORT_SCAN', 'CONNECTION_SPIKE', 'PRIVILEGED_ACCESS'}
  Required: {'PORT_SCAN', 'CONNECTION_SPIKE', 'PRIVILEGED_ACCESS'}
  âœ“ All signals matched!
  Time delta: 0.0 minutes (max: 15)

[DETECTION] ğŸš¨ LATERAL_MOVEMENT
  Source: 10.0.0.5
  Severity: CRITICAL
  Signals: 3

[INFO] Detections saved to SQLite: ../../output/detections.db

============================================================
Detection Summary
============================================================

Detection ID: LM-001-1738166145
Type: LATERAL_MOVEMENT
Source: 10.0.0.5
Severity: CRITICAL
Confidence: HIGH
Signals: 3

Contributing Signals:
  â€¢ PORT_SCAN: MEDIUM
  â€¢ CONNECTION_SPIKE: CRITICAL
  â€¢ PRIVILEGED_ACCESS: CRITICAL

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… DETECTION COMPLETE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“„ Results saved to: ../../output/detections.db

ğŸ” Query detections:
  sqlite3 ../../output/detections.db 'SELECT * FROM detections;'
